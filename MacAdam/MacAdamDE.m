% MacAdamDE%% Clear allclear all% Load dataload MacAdamDataload spd_CIECload T_xyz1931;T_xyz1931 = SplineCmf(S_xyz1931,T_xyz1931,S_CIEC);S_xyz1931 = S_CIEC;% Set jndFactorjndFactor = 1.96;% Find white point, taken to be that of illuminant% C at 24 cd/m2.xyY_C = XYZToxyY(T_xyz1931*spd_CIEC);whiteXYZ = xyYToXYZ([xyY_C(1) xyY_C(2) 24]');nEllipses = size(macAdamData,1);theDEsBg = zeros(nEllipses,4);theDEsSelf = zeros(nEllipses,4);for i1 = 1:nEllipses	x0 = macAdamData(i1,1);	y0 = macAdamData(i1,2);	XYZ0 = xyYToXYZ([x0 y0  48]');	LAB0 = XYZToLab(XYZ0,whiteXYZ);		theta = macAdamData(i1,5)*(pi/180);	aLength = macAdamData(i1,3)/1000;	bLength = macAdamData(i1,4)/1000;	aDx = jndFactor*aLength*cos(theta);	aDy = jndFactor*aLength*sin(theta);	bDx = jndFactor*bLength*cos(theta);	bDy = jndFactor* bLength*sin(theta);	LABa = XYZToLab(xyYToXYZ([x0+aDx y0+aDy 48]'),whiteXYZ);	LABa_ = XYZToLab(xyYToXYZ([x0-aDx y0-aDy 48]'),whiteXYZ);	LABb = XYZToLab(xyYToXYZ([x0+bDx y0+bDy 48]'),whiteXYZ);	LABb_ = XYZToLab(xyYToXYZ([x0-bDx y0-bDy 48]'),whiteXYZ);	theDEsBg(i1,:) = ComputeDE(LAB0(:,[1 1 1 1]),[LABa LABa_ LABb LABb_]);endmeanDEBg = mean(theDEsBg(:));minDEBg = min(theDEsBg(:));maxDEBg = max(theDEsBg(:));fprintf('Mean DE is %g, minimum is %g, max is %g\n',meanDEBg,minDEBg,maxDEBg);aDes = mean(theDEsBg(:,1:2),2);bDes = mean(theDEsBg(:,3:4),2);deRatios = aDes./bDes;meanRatio = mean(deRatios);fprintf('Mean aspect ratio is %g\n',meanRatio);aLengths = macAdamData(:,3);bLengths = macAdamData(:,4);xyRatios = aLengths ./ bLengths;meanxyRatio = mean(xyRatios);fprintf('Mean chromaticity ratio is %g\n',meanxyRatio);